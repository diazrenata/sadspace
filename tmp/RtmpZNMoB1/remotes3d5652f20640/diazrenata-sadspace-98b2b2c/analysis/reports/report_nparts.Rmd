---
title: "SAD space report"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F)
library(drake)
library(sadspace)
library(dplyr)
library(ggplot2)
library(ggpmisc)
```

```{r load stuff}

sv <- define_statevars() %>%
  assign_ptable() %>%
  dplyr::filter(p_table != "none")

#di_df <- read.csv(here::here("analysis", "di_dfs.csv"), stringsAsFactors = F)
fs_size_dat <- read.csv(here::here("analysis", "fs_size_dat.csv"), stringsAsFactors = F)
di_summary_df <- read.csv(here::here("analysis", "di_summary_df.csv"), stringsAsFactors = F)

```

Here is the range of S and N space covered:

```{r plot sn space, fig.dim = c(3.5, 3.5)}

ggplot(sv, aes(s0, n0, color = n0/s0)) +
  geom_point() +
  theme_bw() +
  scale_color_viridis_c(option = "plasma") +
  theme(legend.position = "top")

ggplot(sv, aes(log(s0), log(n0), color = log(n0/s0))) +
  geom_point() +
  theme_bw()+
  scale_color_viridis_c(option = "plasma")+
  theme(legend.position = "top")
```

Things are generally easier to see on the log axis, so let's stick with that.

## Size and unique elements from FS

Here is how the size of the feasible set varies with S, N, and N/S:

```{r plot size of fs 1}
# 
# fs_size_dat <- di_df %>%
#   select(s0, n0, nparts, nunique) %>%
#   distinct() %>%
#   mutate(log_nparts = log(as.numeric(nparts)),
#          log_nunique = log(nunique))

ggplot(fs_size_dat, aes(log(s0), log(n0), color =log_nparts)) +
  geom_point() + 
  theme_bw()+
  scale_color_viridis_c(option = "plasma", begin = .1, end = .8)+
  theme(legend.position = "top")

```


This is *on a log scale*, so up in that right corner is *1.942426e+130*. 

```{r nparts v variability}

ggplot(filter(di_summary_df, s0 >= 3), aes(log_nparts, sd_skew)) +
  geom_point() +
  theme_bw() +
  geom_vline(xintercept = 10)



ggplot(filter(di_summary_df, s0 >= 3), aes(log_nparts, sd_simpson, color = n0)) +
  geom_point() +
  theme_bw() +
  geom_vline(xintercept = 10)
```
